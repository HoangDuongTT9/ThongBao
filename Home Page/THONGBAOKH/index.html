// Biến lưu dữ liệu khách hàng từ file Excel
let customerData = [];

// --- Khi mở trang, kiểm tra nếu đã có dữ liệu trong LocalStorage thì load luôn ---
if (localStorage.getItem('customerData')) {
  customerData = JSON.parse(localStorage.getItem('customerData'));
  alert('Đã tải dữ liệu từ bộ nhớ trình duyệt!');
}

// --- Lắng nghe khi người dùng chọn file Excel mới ---
document.getElementById('excel-file').addEventListener('change', function(e) {
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, {type: 'array'});
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    customerData = XLSX.utils.sheet_to_json(sheet);
    
    // Lưu dữ liệu vào LocalStorage
    localStorage.setItem('customerData', JSON.stringify(customerData));
    
    alert('Đã tải dữ liệu từ Excel và lưu vào bộ nhớ!');
  };
  reader.readAsArrayBuffer(e.target.files[0]);
});
